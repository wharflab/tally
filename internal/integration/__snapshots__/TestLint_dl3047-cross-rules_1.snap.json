{
  "files": [
    {
      "file": "testdata/dl3047-cross-rules/Dockerfile",
      "violations": [
        {
          "detail": "When downloading large files, wget's default progress output produces excessive log lines in Docker builds. Use --progress=dot:giga for a compact progress indicator, or -q/--quiet/-nv/--no-verbose to suppress output entirely.",
          "docUrl": "https://github.com/hadolint/hadolint/wiki/DL3047",
          "location": {
            "end": {
              "column": 0,
              "line": 7
            },
            "file": "testdata/dl3047-cross-rules/Dockerfile",
            "start": {
              "column": 0,
              "line": 7
            }
          },
          "message": "wget without progress bar will bloat build logs; use `wget --progress=dot:giga`, `-q`, or `-nv`",
          "rule": "hadolint/DL3047",
          "severity": "info",
          "sourceCode": "RUN wget http://example.com/archive.tar.gz | tar -xz -C /opt",
          "suggestedFix": {
            "description": "Add --progress=dot:giga to wget",
            "edits": [
              {
                "location": {
                  "end": {
                    "column": 8,
                    "line": 7
                  },
                  "file": "testdata/dl3047-cross-rules/Dockerfile",
                  "start": {
                    "column": 8,
                    "line": 7
                  }
                },
                "newText": " --progress=dot:giga"
              }
            ],
            "priority": 96
          }
        },
        {
          "detail": "Instead of using curl/wget to download an archive and extracting it in a `RUN` command, use `ADD --unpack \u003curl\u003e \u003cdest\u003e` which downloads and extracts in a single layer. This reduces image size and build complexity. Requires BuildKit.",
          "location": {
            "end": {
              "column": 0,
              "line": 7
            },
            "file": "testdata/dl3047-cross-rules/Dockerfile",
            "start": {
              "column": 0,
              "line": 7
            }
          },
          "message": "use `ADD --unpack \u003curl\u003e \u003cdest\u003e` instead of downloading and extracting in `RUN`",
          "rule": "tally/prefer-add-unpack",
          "severity": "info",
          "sourceCode": "RUN wget http://example.com/archive.tar.gz | tar -xz -C /opt",
          "suggestedFix": {
            "description": "Replace with ADD --unpack http://example.com/archive.tar.gz /opt",
            "edits": [
              {
                "location": {
                  "end": {
                    "column": 60,
                    "line": 7
                  },
                  "file": "testdata/dl3047-cross-rules/Dockerfile",
                  "start": {
                    "column": 0,
                    "line": 7
                  }
                },
                "newText": "ADD --unpack http://example.com/archive.tar.gz /opt"
              }
            ],
            "priority": 95,
            "safety": 1
          }
        },
        {
          "detail": "When downloading large files, wget's default progress output produces excessive log lines in Docker builds. Use --progress=dot:giga for a compact progress indicator, or -q/--quiet/-nv/--no-verbose to suppress output entirely.",
          "docUrl": "https://github.com/hadolint/hadolint/wiki/DL3047",
          "location": {
            "end": {
              "column": 0,
              "line": 10
            },
            "file": "testdata/dl3047-cross-rules/Dockerfile",
            "start": {
              "column": 0,
              "line": 10
            }
          },
          "message": "wget without progress bar will bloat build logs; use `wget --progress=dot:giga`, `-q`, or `-nv`",
          "rule": "hadolint/DL3047",
          "severity": "info",
          "sourceCode": "RUN wget http://example.com/config.json -O /etc/app/config.json",
          "suggestedFix": {
            "description": "Add --progress=dot:giga to wget",
            "edits": [
              {
                "location": {
                  "end": {
                    "column": 8,
                    "line": 10
                  },
                  "file": "testdata/dl3047-cross-rules/Dockerfile",
                  "start": {
                    "column": 8,
                    "line": 10
                  }
                },
                "newText": " --progress=dot:giga"
              }
            ],
            "priority": 96
          }
        },
        {
          "detail": "Using both wget and curl increases image size and maintenance burden. Standardize on one tool. curl is generally preferred in containers due to better scripting support and broader protocol support.",
          "docUrl": "https://github.com/hadolint/hadolint/wiki/DL4001",
          "location": {
            "end": {
              "column": 0,
              "line": 13
            },
            "file": "testdata/dl3047-cross-rules/Dockerfile",
            "start": {
              "column": 0,
              "line": 13
            }
          },
          "message": "both wget and curl are used; pick one to reduce image size and complexity",
          "rule": "hadolint/DL4001",
          "severity": "warning",
          "sourceCode": "RUN curl -fsSL http://example.com/script.sh | sh"
        }
      ]
    }
  ],
  "files_scanned": 1,
  "rules_enabled": 3,
  "summary": {
    "errors": 0,
    "files": 1,
    "info": 3,
    "style": 0,
    "total": 4,
    "warnings": 1
  }
}